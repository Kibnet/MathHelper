# ะะปะฐะฒะฐััะธะต ะผะฐัะตะผะฐัะธัะตัะบะธะต ััะธะปะธัั

## 0. ะะตัะฐะดะฐะฝะฝัะต
- ะขะธะฟ (ะฟัะพัะธะปั): product-system-design
- ะะปะฐะดะตะปะตั: ะฟะพะปัะทะพะฒะฐัะตะปั
- ะะฐัััะฐะฑ: medium
- ะฆะตะปะตะฒะพะน ัะตะปะธะท / ะฒะตัะบะฐ: main
- ะะณัะฐะฝะธัะตะฝะธั: vanilla TypeScript, ะฑะตะท React
- ะกะฒัะทะฐะฝะฝัะต ัััะปะบะธ: โ

## 1. Overview / ะฆะตะปั
ะะพะฑะฐะฒะธัั ะฒัะฟะฐะดะฐััะตะต ะผะตะฝั ะฒ ะทะฐะณะพะปะพะฒะพะบ ะฟัะธะปะพะถะตะฝะธั ั ะดะพัััะฟะพะผ ะบ ะฟะปะฐะฒะฐััะธะผ ะผะฐัะตะผะฐัะธัะตัะบะธะผ ััะธะปะธัะฐะผ:
1. **ะคะฐะบัะพัะธะทะฐัะธั ัะธัะปะฐ** โ ัะฐะทะปะพะถะตะฝะธะต ะฝะฐ ะผะฝะพะถะธัะตะปะธ, ะฟัะพัััะต ะดะตะปะธัะตะปะธ, ะฒัะต ะดะตะปะธัะตะปะธ
2. **ะะพะฝะฒะตััะตั ะดัะพะฑะตะน** โ ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะดัะพะฑะธ ะฒ ะดะตัััะธัะฝะพะต ัะธัะปะพ, ัะพะบัะฐััะฝะฝัั ะดัะพะฑั, ัะผะตัะฐะฝะฝะพะต ัะธัะปะพ

## 2. ะขะตะบััะตะต ัะพััะพัะฝะธะต (AS-IS)
- ะะฐะณะพะปะพะฒะพะบ (`app-header`) ัะพะดะตัะถะธั ัะพะปัะบะพ ะฝะฐะทะฒะฐะฝะธะต ะฟัะธะปะพะถะตะฝะธั
- ะะตั ะฝะฐะฒะธะณะฐัะธะพะฝะฝะพะณะพ ะผะตะฝั ะธะปะธ ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะธะฝััััะผะตะฝัะพะฒ
- UI ะฟะพัััะพะตะฝ ะฝะฐ vanilla TypeScript ั ะบะพะผะฟะพะฝะตะฝัะฐะผะธ ะฒ `src/ui/components/`
- ะกัะธะปะธ ะฒ `src/ui/styles/base.css` ะธ `components.css`

## 3. ะัะพะฑะปะตะผะฐ
ะะพะปัะทะพะฒะฐัะตะปั ะฝัะถะฝั ะดะพะฟะพะปะฝะธัะตะปัะฝัะต ะผะฐัะตะผะฐัะธัะตัะบะธะต ะธะฝััััะผะตะฝัั, ะบะพัะพััะต ะฝะต ัะฒัะทะฐะฝั ะฝะฐะฟััะผัั ั ัะตะดะฐะบัะธัะพะฒะฐะฝะธะตะผ ะฒััะฐะถะตะฝะธะน, ะฝะพ ะฟะพะปะตะทะฝั ะฟัะธ ัะฐะฑะพัะต ั ะฝะธะผะธ.

## 4. ะฆะตะปะธ ะดะธะทะฐะนะฝะฐ
- **ะะฐะทะดะตะปะตะฝะธะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ**: ะบะฐะถะดะฐั ััะธะปะธัะฐ โ ะพัะดะตะปัะฝัะน ะบะพะผะฟะพะฝะตะฝั
- **ะะพะฒัะพัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต**: ะพะฑัะธะน ะฑะฐะทะพะฒัะน ะบะปะฐัั ะดะปั ะฟะปะฐะฒะฐััะธั ะฟะฐะฝะตะปะตะน
- **ะขะตััะธััะตะผะพััั**: ัะธัััะต ััะฝะบัะธะธ ะดะปั ะผะฐัะตะผะฐัะธัะตัะบะธั ัะฐััััะพะฒ
- **ะะพะฝัะธััะตะฝัะฝะพััั**: ััะธะปะธ ัะพะพัะฒะตัััะฒััั ัััะตััะฒัััะตะผั ะดะธะทะฐะนะฝั
- **ะะตะธะฝะฒะฐะทะธะฒะฝะพััั**: ััะธะปะธัั ะฝะต ะผะตัะฐัั ะพัะฝะพะฒะฝะพะผั ััะฝะบัะธะพะฝะฐะปั

## 5. Non-Goals (ัะตะณะพ ะะ ะดะตะปะฐะตะผ)
- ะะฝัะตะณัะฐัะธั ััะธะปะธั ั ัะตะดะฐะบัะพัะพะผ ะฒััะฐะถะตะฝะธะน (ะฒััะฐะฒะบะฐ ัะตะทัะปััะฐัะพะฒ)
- ะกะพััะฐะฝะตะฝะธะต ะธััะพัะธะธ ัะฐััััะพะฒ ััะธะปะธั
- Drag-and-drop ะฟะตัะตะผะตัะตะฝะธะต ะฟะฐะฝะตะปะตะน
- ะะฝะพะถะตััะฒะตะฝะฝัะต ะพัะบััััะต ะฟะฐะฝะตะปะธ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ

## 6. ะัะตะดะปะฐะณะฐะตะผะพะต ัะตัะตะฝะธะต (TO-BE)

### 6.1 UI-ััััะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ๐งฎ ะัะตะพะฑัะฐะทะพะฒะฐัะตะปั ะฒััะฐะถะตะฝะธะน    [โ๏ธ ะฃัะธะปะธัั โผ]        โ
โ                                   โโโโโโโโโโโโโโโโโโโโ  โ
โ                                   โ ะคะฐะบัะพัะธะทะฐัะธั     โ  โ
โ                                   โ ะะพะฝะฒะตััะตั ะดัะพะฑะตะน โ  โ
โ                                   โโโโโโโโโโโโโโโโโโโโ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

ะัะธ ะฒัะฑะพัะต ััะธะปะธัั ะพัะบััะฒะฐะตััั ะฟะปะฐะฒะฐััะฐั ะฟะฐะฝะตะปั:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ะคะฐะบัะพัะธะทะฐัะธั ัะธัะปะฐ          [ร] โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ะงะธัะปะพ: [_______________] [OK]   โ
โ                                 โ
โ ะะตะทัะปััะฐั:                      โ
โ โข ะัะพัััะต ะผะฝะพะถะธัะตะปะธ: 2ยฒ ร 3     โ
โ โข ะะฐัั ะผะฝะพะถะธัะตะปะตะน: (1,12)...    โ
โ โข ะัะต ะดะตะปะธัะตะปะธ: 1, 2, 3, 4...   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### 6.2 ะััะธัะตะบัััะฐ ะบะพะผะฟะพะฝะตะฝัะพะฒ

```
src/ui/components/
โโโ FloatingPanel.ts        # ะะฐะทะพะฒัะน ะบะปะฐัั ะฟะปะฐะฒะฐััะตะน ะฟะฐะฝะตะปะธ
โโโ UtilityMenu.ts          # ะัะฟะฐะดะฐััะตะต ะผะตะฝั ััะธะปะธั
โโโ FactorizationTool.ts    # ะฃัะธะปะธัะฐ ัะฐะบัะพัะธะทะฐัะธะธ
โโโ FractionConverterTool.ts # ะฃัะธะปะธัะฐ ะดัะพะฑะตะน

src/utils/
โโโ factorization.ts        # ะงะธัััะต ััะฝะบัะธะธ ัะฐะบัะพัะธะทะฐัะธะธ
โโโ fractions.ts            # ะงะธัััะต ััะฝะบัะธะธ ะดะปั ะดัะพะฑะตะน
```

### 6.3 API ััะธะปะธั

**factorization.ts:**
```typescript
interface FactorizationResult {
  primeFactors: Map<number, number>;  // ะพัะฝะพะฒะฐะฝะธะต โ ััะตะฟะตะฝั
  factorPairs: [number, number][];    // ะฟะฐัั ะผะฝะพะถะธัะตะปะตะน
  allDivisors: number[];              // ะฒัะต ะดะตะปะธัะตะปะธ
}

function factorize(n: number): FactorizationResult;
function formatPrimeFactors(factors: Map<number, number>): string;
```

**fractions.ts:**
```typescript
interface FractionResult {
  decimal: number;
  simplified: { numerator: number; denominator: number };
  mixed: { whole: number; numerator: number; denominator: number } | null;
}

function convertFraction(numerator: number, denominator: number): FractionResult;
function gcd(a: number, b: number): number;
```

### 6.4 ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ
- ะคะฐะบัะพัะธะทะฐัะธั: ะฟัะพะฒะตัะบะฐ ะฝะฐ ะฟะพะปะพะถะธัะตะปัะฝะพะต ัะตะปะพะต ัะธัะปะพ
- ะัะพะฑะธ: ะฟัะพะฒะตัะบะฐ ะดะตะปะตะฝะธั ะฝะฐ ะฝะพะปั, ะฒะฐะปะธะดะฐัะธั ัะธัะตะป
- ะัะพะฑัะฐะถะตะฝะธะต ะพัะธะฑะพะบ ะฒะฝัััะธ ะฟะฐะฝะตะปะธ (ะฝะต alert)

## 7. ะะธะทะฝะตั-ะฟัะฐะฒะธะปะฐ / ะะปะณะพัะธัะผั

### ะคะฐะบัะพัะธะทะฐัะธั
1. ะะฐะทะปะพะถะตะฝะธะต ะฝะฐ ะฟัะพัััะต ะผะฝะพะถะธัะตะปะธ ะผะตัะพะดะพะผ ะฟัะพะฑะฝะพะณะพ ะดะตะปะตะฝะธั
2. ะะฐัั ะผะฝะพะถะธัะตะปะตะน: ะฟะตัะตะฑะพั ะดะพ โn
3. ะัะต ะดะตะปะธัะตะปะธ: ะธะท ะฟัะพัััั ะผะฝะพะถะธัะตะปะตะน ัะตัะตะท ะบะพะผะฑะธะฝะฐัะธะธ ััะตะฟะตะฝะตะน

### ะัะพะฑะธ
1. ะะะ ัะตัะตะท ะฐะปะณะพัะธัะผ ะะฒะบะปะธะดะฐ
2. ะกะพะบัะฐัะตะฝะธะต: ะดะตะปะตะฝะธะต ะฝะฐ ะะะ
3. ะกะผะตัะฐะฝะฝะพะต ัะธัะปะพ: ะตัะปะธ |ัะธัะปะธัะตะปั| > |ะทะฝะฐะผะตะฝะฐัะตะปั|

## 8. ะขะพัะบะธ ะธะฝัะตะณัะฐัะธะธ ะธ ััะธะณะณะตัั
- ะะฝะพะฟะบะฐ ะผะตะฝั ะฒ `index.html` โ ัะพะทะดะฐะฝะธะต `UtilityMenu`
- ะะปะธะบ ะฟะพ ะฟัะฝะบัั ะผะตะฝั โ ะพัะบัััะธะต ัะพะพัะฒะตัััะฒัััะตะน ะฟะฐะฝะตะปะธ
- ะะปะธะบ ะฒะฝะต ะฟะฐะฝะตะปะธ ะธะปะธ [ร] โ ะทะฐะบัััะธะต ะฟะฐะฝะตะปะธ
- Enter ะฒ ะฟะพะปะต ะฒะฒะพะดะฐ โ ัะฐัััั

## 9. ะะทะผะตะฝะตะฝะธั ะผะพะดะตะปะธ ะดะฐะฝะฝัั / ัะพััะพัะฝะธั
ะะพะฒะพะต ัะพััะพัะฝะธะต ะฝะต persisted, ัะพะปัะบะพ runtime:
- `activePanel: 'factorization' | 'fraction' | null`
- ะะพะบะฐะปัะฝะพะต ัะพััะพัะฝะธะต ะบะฐะถะดะพะน ะฟะฐะฝะตะปะธ (ะฒะฒะพะด, ัะตะทัะปััะฐั)

## 10. ะะธะณัะฐัะธั / Rollout / Rollback
- ะะพะฒัะน ััะฝะบัะธะพะฝะฐะป, ะพะฑัะฐัะฝะฐั ัะพะฒะผะตััะธะผะพััั ะฝะต ััะตะฑัะตััั
- ะัะบะฐั: ัะดะฐะปะตะฝะธะต ะฝะพะฒัั ัะฐะนะปะพะฒ ะธ ะธะทะผะตะฝะตะฝะธะน ะฒ index.html

## 11. ะขะตััะธัะพะฒะฐะฝะธะต ะธ ะบัะธัะตัะธะธ ะฟัะธัะผะบะธ

### Acceptance Criteria
- [ ] ะะตะฝั "ะฃัะธะปะธัั" ะพัะพะฑัะฐะถะฐะตััั ะฒ ะทะฐะณะพะปะพะฒะบะต
- [ ] ะะปะธะบ ะพัะบััะฒะฐะตั ะฒัะฟะฐะดะฐััะธะน ัะฟะธัะพะบ ั ะดะฒัะผั ะฟัะฝะบัะฐะผะธ
- [ ] ะัะฑะพั ะฟัะฝะบัะฐ ะพัะบััะฒะฐะตั ะฟะปะฐะฒะฐัััั ะฟะฐะฝะตะปั
- [ ] ะคะฐะบัะพัะธะทะฐัะธั: ะฒะฒะพะด 12 โ ะฟะพะบะฐะทัะฒะฐะตั 2ยฒ ร 3, ะฟะฐัั, ะดะตะปะธัะตะปะธ
- [ ] ะัะพะฑะธ: ะฒะฒะพะด 7/4 โ ะฟะพะบะฐะทัะฒะฐะตั 1.75, 7/4, 1 3/4
- [ ] ะะฐะฝะตะปั ะทะฐะบััะฒะฐะตััั ะฟะพ [ร] ะธะปะธ ะบะปะธะบั ะฒะฝะต
- [ ] ะกัะธะปะธ ัะพะพัะฒะตัััะฒััั ะพะฑัะตะผั ะดะธะทะฐะนะฝั

### ะขะตััั
- Unit-ัะตััั ะดะปั `factorization.ts` ะธ `fractions.ts`
- E2E ัะตัั ะพัะบัััะธั/ะทะฐะบัััะธั ะฟะฐะฝะตะปะตะน

### ะะพะผะฐะฝะดั
```bash
npm run test:run
npm run test:e2e:with-dev
```

## 12. ะะธัะบะธ ะธ edge cases
| ะะธัะบ | ะกะผัะณัะตะฝะธะต |
|------|-----------|
| ะะพะปััะธะต ัะธัะปะฐ (>10^9) | ะะณัะฐะฝะธัะธัั ะผะฐะบัะธะผัะผ, ะฟะพะบะฐะทะฐัั ะฟัะตะดัะฟัะตะถะดะตะฝะธะต |
| ะััะธัะฐัะตะปัะฝัะต ัะธัะปะฐ | ะคะฐะบัะพัะธะทะฐัะธั: ะผะพะดัะปั; ะัะพะฑะธ: ัะพััะฐะฝะธัั ะทะฝะฐะบ |
| ะัะพะฑะฝัะน ะฒะฒะพะด ะฒ ัะฐะบัะพัะธะทะฐัะธั | ะะบััะณะปะตะฝะธะต ั ะฟัะตะดัะฟัะตะถะดะตะฝะธะตะผ |
| 0 ะฒ ะทะฝะฐะผะตะฝะฐัะตะปะต | ะกะพะพะฑัะตะฝะธะต ะพะฑ ะพัะธะฑะบะต |

## 13. ะะปะฐะฝ ะฒัะฟะพะปะฝะตะฝะธั
1. ะกะพะทะดะฐัั `src/utils/factorization.ts` ั unit-ัะตััะฐะผะธ
2. ะกะพะทะดะฐัั `src/utils/fractions.ts` ั unit-ัะตััะฐะผะธ
3. ะกะพะทะดะฐัั ะฑะฐะทะพะฒัะน `FloatingPanel.ts`
4. ะกะพะทะดะฐัั `UtilityMenu.ts`
5. ะกะพะทะดะฐัั `FactorizationTool.ts`
6. ะกะพะทะดะฐัั `FractionConverterTool.ts`
7. ะะพะฑะฐะฒะธัั ััะธะปะธ ะฒ `components.css`
8. ะะฑะฝะพะฒะธัั `index.html` ะธ `ExpressionEditorApp.ts`
9. ะะพะฑะฐะฒะธัั E2E ัะตััั
10. ะคะธะฝะฐะปัะฝะฐั ะฟัะพะฒะตัะบะฐ

## 14. ะัะบััััะต ะฒะพะฟัะพัั
ะะตั ะฑะปะพะบะธััััะธั ะฒะพะฟัะพัะพะฒ.

## 15. ะะตะทัะปััะฐั ะฟัะพะณะพะฝะฐ ะปะธะฝัะตัะฐ

### A. ะะพะปะฝะพัะฐ ัะฟะตะบะธ
1. ะงััะบะฐั ัะตะปั โ **PASS** (ะดะพะฑะฐะฒะธัั ะผะตะฝั ั ััะธะปะธัะฐะผะธ)
2. AS-IS โ **PASS** (ะพะฟะธัะฐะฝะพ ัะตะบััะตะต ัะพััะพัะฝะธะต ะทะฐะณะพะปะพะฒะบะฐ)
3. ะะดะฝะฐ ะฟัะพะฑะปะตะผะฐ โ **PASS** (ะฝัะถะฝั ะดะพะฟ. ะธะฝััััะผะตะฝัั)
4. ะฆะตะปะธ ะดะธะทะฐะนะฝะฐ โ **PASS** (5 ัะตะปะตะน)
5. Non-Goals โ **PASS** (4 ะฟัะฝะบัะฐ)

### B. ะะฐัะตััะฒะพ ะดะธะทะฐะนะฝะฐ
6. ะะฐัะฟัะตะดะตะปะตะฝะธะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ โ **PASS** (ะบะพะผะฟะพะฝะตะฝัั + ััะธะปะธัั)
7. ะขะพัะบะธ ะธะฝัะตะณัะฐัะธะธ โ **PASS** (ัะตะบัะธั 8)
8. ะะธะทะฝะตั-ะปะพะณะธะบะฐ โ **PASS** (ะฐะปะณะพัะธัะผั ะฒ ัะตะบัะธะธ 7)
9. ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ โ **PASS** (ัะตะบัะธั 6.4)
10. ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั โ **PASS** (ะพะณัะฐะฝะธัะตะฝะธะต ะฑะพะปััะธั ัะธัะตะป)

### C. ะะตะทะพะฟะฐัะฝะพััั ะธะทะผะตะฝะตะฝะธะน
11. ะะพะดะตะปั ะดะฐะฝะฝัั โ **PASS** (ัะพะปัะบะพ runtime ัะพััะพัะฝะธะต)
12. ะะปะฐะฝ ะผะธะณัะฐัะธะธ โ **PASS** (ะฝะต ััะตะฑัะตััั)
13. ะะฑัะฐัะฝะฐั ัะพะฒะผะตััะธะผะพััั โ **PASS** (ะฝะพะฒัะน ััะฝะบัะธะพะฝะฐะป)

### D. ะัะพะฒะตััะตะผะพััั
14. ะัะธัะตัะธะธ ะฟัะธัะผะบะธ โ **PASS** (7 ัะตะบะฑะพะบัะพะฒ)
15. ะะปะฐะฝ ัะตััะธัะพะฒะฐะฝะธั โ **PASS** (unit + E2E)
16. ะะพะผะฐะฝะดั ะฟัะพะฒะตัะบะธ โ **PASS** (npm scripts)

### E. ะะพัะพะฒะฝะพััั ะบ ะฐะฒัะพะฝะพะผะฝะพะน ัะตะฐะปะธะทะฐัะธะธ
17. ะะพัะฐะณะพะฒัะน ะฟะปะฐะฝ โ **PASS** (10 ัะฐะณะพะฒ)
18. ะัะบััััะต ะฒะพะฟัะพัั โ **PASS** (ะฝะตั)
19. ะะฐัััะฐะฑ/ะณะปัะฑะธะฝะฐ โ **PASS** (medium, ะดะพััะฐัะพัะฝะฐั ะดะตัะฐะปะธะทะฐัะธั)

### F. ะกะพะพัะฒะตัััะฒะธะต ะฟัะพัะธะปั (product-system-design)
20. ะฆะตะปะธ/non-goals โ **PASS**
    ะััะธัะตะบัััะฐ โ **PASS**
    ะัะฑะปะธัะฝัะน API โ **PASS**
    UX/ะฝะฐัััะพะนะบะธ โ **PASS**
    ะะตะทะพะฟะฐัะฝะพััั โ **N/A** (ะฝะตั sensitive ะดะฐะฝะฝัั)

**ะัะพะณ: ะะะขะะะ** โ ะฝะตั FAIL

---

## Approval
ะะถะธะดะฐะตััั ััะฐะทะฐ: **"ะกะฟะตะบั ะฟะพะดัะฒะตัะถะดะฐั"**
